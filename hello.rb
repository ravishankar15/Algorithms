5
[3,4,1,1,0,0]
3
[0,0,0,0]
10
[0, 3, 1, 2, 4, 0, 3, 1, 2, 4, 1]
6
[3,0,0,0,0,0,1]
9
[2, 0, 3, 1, 4, 2, 0, 3, 1, 4]
5
[4, 2, 3, 4, 2, 3]
1899
[19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15, 19, 10, 2, 20, 3, 4, 18, 14, 9, 6, 11, 7, 8, 13, 12, 16, 5, 17, 15]

# @param {Integer} n
# @param {Integer[]} ranges
# @return {Integer}
def min_taps(n, ranges)
    water_ranges = []
    ranges.each_with_index do |range, idx|
        next if range == 0

        water_ranges << [[idx-range, 0].max, idx + range]
    end
    water_ranges.sort!

    puts water_ranges.inspect

    return -1 if water_ranges.empty?


    min_taps = 1
    cstart, cend = water_ranges[0]
    i = 1
    wlen = water_ranges.size
    while(i < wlen)
        nend = -1
        while(i < wlen && water_ranges[i][0] < cend)
            if cstart == water_ranges[i][0]
                cend = [cend, water_ranges[i][1]].max
            end

            nend = [nend, water_ranges[i][1]].max
            i += 1
        end

        return -1 if nend == -1

        break if i >= wlen && cend >= n

        min_taps += 1
        cstart, cend = nend, nend
    end

    # puts "#{min_taps}; #{nend}; #{n}; #{nend >= n}; #{i}; #{cend}"

    min_taps
end

# @param {Integer} n
# @param {Integer[]} ranges
# @return {Integer}
def min_taps(n, ranges)
    water_ranges = []
    ranges.each_with_index do |range, idx|
        next if range == 0

        water_ranges << [[idx-range, 0].max, idx + range]
    end
    water_ranges.sort!

    puts water_ranges.inspect

    c_start, c_end = 0, 0
    min_taps = 1
    water_ranges.each do |wrange|
        r_start, r_end = wrange

        if c_start == r_start
            c_end = [c_end, r_end].max
        else
            if r_end > c_end
                c_start, c_end = r_start, r_end
                min_taps += 1
            end
        end
    end

    puts "#{min_taps}; #{c_end}; #{n}; #{c_end == n}"

    return min_taps if c_end == n

    -1
end

1
1
[]
100
1
[[10,100]]
100
10
[[10,60],[20,30],[30,30],[60,40]]
9
5
[[2,3],[3,2],[4,1],[6,3],[8,1]]
444
299
[[13, 21], [26, 115], [100, 47], [192, 255], [225, 99], [231, 157], [256, 123], [299, 141], [324, 190], [439, 115]]
100
50
[[25,50],[50,25]]
1000
83
[[15,457],[156,194],[160,156],[230,314],[390,159],[621,20],[642,123],[679,301],[739,229],[751,174]]

# @param {Integer} target
# @param {Integer} start_fuel
# @param {Integer[][]} stations
# @return {Integer}
def min_refuel_stops(target, start_fuel, stations)
    return 0 if start_fuel >= target

    stations.unshift([0, start_fuel])
    # stations.sort!
    puts "#{stations.inspect}"
    slen = stations.size
    pidx = 0
    prev_max_fuel = start_fuel
    stops = 0
    while(pidx < slen)
        curr_fuel = 0
        curr_max_fuel = 0
        max_idx = 2**32
        for cidx in (pidx+1)...slen
            req_fuel = prev_max_fuel - (stations[cidx][0] - stations[pidx][0])
            break if req_fuel < 0
            curr_fuel = req_fuel + stations[cidx][1]
            if curr_fuel > curr_max_fuel
                curr_max_fuel = curr_fuel
                max_idx = cidx
                return stops+1 if curr_max_fuel >= (target-(stations[cidx][0] - stations[pidx][0]))

                return stops if curr_max_fuel >= (target-(req_fuel))
            end
        end
        puts "#{pidx}; #{max_idx}; #{stops}; #{[curr_max_fuel, max_idx].inspect}"
        return -1 if max_idx >= 2**32

        stops += 1

        return stops if curr_max_fuel >= (target - stations[max_idx][0])

        pidx = max_idx
        prev_max_fuel = curr_max_fuel
    end
    stops
end


# @param {Integer} target
# @param {Integer} start_fuel
# @param {Integer[][]} stations
# @return {Integer}
def min_refuel_stops(target, start_fuel, stations)
    @target = target
    @stations = stations.sort
    @slen = stations.size
    return (start_fuel >= 1 ? 0 : -1) if target == 1

    mrs = min_stops(-1, 0, start_fuel)
    mrs >= 2**32 ? -1 : mrs
end

def min_stops(psi, si, remain_fuel)
    # puts "#{psi}; #{si}; #{remain_fuel}"

    return 2**32 if si >= @slen || remain_fuel < (@stations[si][0] - (psi == -1 ? 0 : @stations[psi][0]))

    # return 0 if remain_fuel >= (@target-@stations[si][0])

    new_fuel = remain_fuel - (@stations[si][0] - (psi == -1 ? 0 : @stations[psi][0])) + @stations[si][1]

    return 1 if new_fuel >= (@target - @stations[si][0])

    # puts "#{psi}; #{si}; #{remain_fuel}; #{new_fuel}"
    [min_stops(si, si+1, new_fuel),
        min_stops(psi, si+1, remain_fuel)].min + 1
end

# @param {Integer} target
# @param {Integer} start_fuel
# @param {Integer[][]} stations
# @return {Integer}
def min_refuel_stops(target, start_fuel, stations)
    @target = target
    @stations = stations.sort
    @slen = stations.size
    return (start_fuel >= 1 ? 0 : -1) if target == 1

    mrs = min_stops(-1, 0, start_fuel)
    mrs == 2**32 ? -1 : mrs
end

def min_stops(psi, si, remain_fuel)
    return 2**32 if si >= @slen || remain_fuel < @stations[si][0]

    return 0 if remain_fuel >= (@target-(@stations[si][0] - (psi == -1 ? 0 : @stations[psi][0])))

    new_fuel = curr_fuel-(@stations[si][0] - (psi == -1 ? 0 : @stations[psi][0])) + @stations[si][1]
    puts "#{psi}; #{si}; #{curr_fuel}; #{new_fuel}"
    [min_stops(si, si+1, new_fuel),
        min_stops(psi, si+1, curr_fuel)].min + 1
end

# @param {Integer} n
# @param {Integer[]} cost
# @return {Integer}
def min_increments(n, cost)
    @cost = cost
    @prefix = Array.new(n, 0)
    @max_sum = 0
    @min_cost = 0
    
    max_lsum(0, 0)
    puts @max_sum
    mic(0, 0)

    @min_cost
end

def mic(ri, prefix)
    return @cost[ri] if @cost[left(ri)].nil? && @cost[right(ri)].nil?
    
    prefix += @cost[ri]
    lt = mic(left(ri), prefix)
    rt = mic(right(ri), prefix)
    puts "#{lt}; #{rt}"
    ldiff = @max_sum - (@prefix[ri]+lt)
    rdiff = @max_sum - (@prefix[ri]+rt)
    cdiff = [ldiff, rdiff].min
    @prefix[ri] += cdiff
    
    puts "#{@min_diff}; #{cdiff}; #{(@max_sum - @prefix[ri]+lt)}; #{(@max_sum - @prefix[ri]+rt)}"
    @min_cost += cdiff
    @min_cost += (@max_sum - @prefix[ri]+lt)
    @min_cost += (@max_sum - @prefix[ri]+rt)
    
    puts "#{@min_cost}"
    # puts "#{ri}; #{ldiff}; #{rdiff}; #{@prefix[ri]+lt}; #{@prefix[ri]+rt}; #{@prefix[ri]}"
    @prefix[ri]
end

def max_lsum(ri, sum)
    if @cost[left(ri)].nil? && @cost[right(ri)].nil?
        @max_sum = [sum + @cost[ri], @max_sum].max
        return
    end
    max_lsum(left(ri), sum+@cost[ri])
    max_lsum(right(ri), sum+@cost[ri])
end

def left(ri)
    (2*ri)+1
end

def right(ri)
    (2*ri)+2
end